"use strict";var yapp=angular.module("yapp",["ui.router","ngAnimate"]);yapp.config(["$stateProvider","$urlRouterProvider",function(e,t){t.when("/dashboard","/dashboard/overview"),t.when("/logout","dashboard/login"),t.otherwise("/login"),e.state("base",{"abstract":!0,url:"",templateUrl:"views/base.html"}).state("login",{url:"/login",parent:"base",templateUrl:"views/login.html",controller:"LoginCtrl"}).state("dashboard",{url:"/dashboard",parent:"base",templateUrl:"views/dashboard.html",controller:"DashboardCtrl"}).state("overview",{url:"/overview",parent:"dashboard",templateUrl:"views/dashboard/overview.html"}).state("profile",{url:"/profile",parent:"dashboard",templateUrl:"views/dashboard/profile.html",controller:"teacherCtrl"}).state("courselist",{url:"/courselist",parent:"dashboard",templateUrl:"views/dashboard/courselist.html",controller:"teacherCourseCtrl"}).state("studentlist",{url:"/studentlist",parent:"dashboard",templateUrl:"views/dashboard/studentlist.html",controller:"studentsByCourseCtrl"}).state("statistics",{url:"/statistics",parent:"dashboard",templateUrl:"views/dashboard/statistics.html"}).state("logout",{url:"/logout",parent:"dashboard",templateUrl:"views/login.html",controller:"logoutctrl"}).state("reports",{url:"/reports",parent:"dashboard",templateUrl:"views/dashboard/reports.html"})}]),yapp.controller("logoutctrl",["$scope","loginService",function(e,t){e.txt="Page Home",t.logout(),e.username=sessionStorage.getItem("user"),console.log("entro log",e.username)}]),yapp.factory("loginService",["$http","$location","sessionService",function(e,t,s){var o,r;return{login:function(n,a){a.data={};e.post("http://asistencia.utbweb.co/token",n).then(function(e){var a=e.data;a&&(s.set("user",n.username),s.set("token",a),o=n.username,r=a,console.log(o),t.path("/dashboard"))})["catch"](function(){a.msgtxt="Datos del profesor incorrectos",Materialize.toast(a.msgtxt,5e3,"rounded")})},logout:function(){s.destroy("user"),s.destroy("token"),t.path("/login")},islogged:function(){var t=e.post("http://asistencia.utbweb.co/token");return t}}}]),yapp.factory("sessionService",["$http",function(e){return{set:function(e,t){return sessionStorage.setItem(e,t)},get:function(e){return sessionStorage.getItem(e)},destroy:function(e){return console.log("Destroy-key: ",e),sessionStorage.removeItem(e)}}}]),angular.module("yapp").controller("teacherCtrl",["$scope","loginService","$http",function(e,t,s,o){console.log(sessionStorage.getItem("user")),s({url:"http://104.236.31.197/teacher/"+sessionStorage.getItem("user"),method:"GET",data:$.param({username:sessionStorage.getItem("user"),token:sessionStorage.getItem("token")})}).success(function(t){console.log(t),e.json=t,e.id=e.json.id,e.names=e.json.names,e.lastnames=e.json.lastnames,e.type=e.json.type,e.department=e.json.department,e.school=e.json.school,e.email=e.json.email})}]),angular.module("yapp").controller("teacherCourseCtrl",["$scope","$location","$http",function(e,t,s){s({url:"http://104.236.31.197/teacher/T00010915/courses",method:"GET",data:$.param({username:sessionStorage.getItem("user"),token:sessionStorage.getItem("token")})}).success(function(t){console.log(t),e.json=t,e.courses=t.courses,e.id=e.json.id,e.names=e.json.names,e.lastnames=e.json.lastnames,e.resources_uri=e.json.resources_uri,e.coursename=e.json.courses.subjct_name}),console.log(e.username),sessionStorage.getItem("user")==e.username&&t.path("/login")}]),angular.module("yapp").controller("studentsByCourseCtrl",["$scope","$location","$http",function(e,t,s){s({url:"http://104.236.31.197/course/2028-201510/students",method:"GET",data:$.param({username:sessionStorage.getItem("user"),token:sessionStorage.getItem("token")})}).success(function(o){console.log(o),e.json=o,e.nrc=e.json.nrc,e.subject=e.json.subject,e.students=e.json.students,e.names=e.json.students.names,e.lastnames=e.json.students.lastnames,e.id=e.json.students.id;var r;e.selection=[],e.toggleSelection=function(t,s){e.selection.push({id:t,attendance:"0"}),console.log(r)},sessionStorage.getItem("user")===e.username&&t.path("/login");JSON.stringify;e.studentPost=function(){var t=JSON.stringify({nrc:e.nrc,estudiantes:e.selection});console.log(t);s({method:"post",url:"http://localhost:8000/attendance?username=T00010915&token=GZmd0e0wBDca8lfE5jAYADTFgcXRinHHmpKAXUGS",data:t})}})}]),angular.module("yapp").controller("LoginCtrl",["$scope","loginService",function(e,t,s){e.msgtxt="",e.login=function(s){console.log("data:",s),console.log("asasdabsdasd:"),t.login(s,e)}}]),angular.module("yapp").controller("DashboardCtrl",["$scope","$state",function(e,t){e.id=sessionStorage.getItem("user"),e.$state=t}]);